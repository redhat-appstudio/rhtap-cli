`tssc-tpa-realm`: TSSC Trusted Profile Analyzer Realm
-----------------------------------------------------

# Contributing

## Keycloak Chicken Realm

Trustification components rely, by default, on Keycloak for identify and access management.

Therefore the project will create a Realm named `chicken` for this purpose, relying on the Keycloak operator to manage the Realm installation.

To update the `KeycloakRealmImport` template follow the steps:

1. Run the [`trustification-infrastructure` Helm chart][trustificationInfra] installer using its default Keycloak instance.
2. Login to the instance, use the keycloak web-interface to export the Realm, including `clients` and `roles`, to a JSON file.
3. Use the Python script documented below to generate the `KeycloakRealmImport` CRD file.
4. Merge the CRD generated by the script with `KeycloakRealmImport` in [realm.yaml](templates/realm.yaml).


### Generate `KeycloakRealmImport` Script

Once you have the Realm export JSON file, use it as the first argument for the Python script:

```sh
python hack/generate-keycloakrealmimport.py <realm-export-json> <crd-yaml>
```

The second argument is the path of the output CRD YAML file.

[trustificationInfra]: https://github.com/trustification/trustification/tree/1d65f2c1cce303a89f1f9ca1e8cd6285f1d23de0/deploy/k8s/charts/trustification-infrastructure
